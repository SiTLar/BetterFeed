!function(e){function t(i){if(n[i])return n[i].exports;var o=n[i]={exports:{},id:i,loaded:!1};return e[i].call(o.exports,o,o.exports,t),o.loaded=!0,o.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){n(9);var i=n(1),o=[n(3)];i.init(),i.loadSettings().then(function(e){for(var t in e)e.hasOwnProperty(t)&&e[t]===!0&&o.push(n(2)("./"+t));var i=new MutationObserver(function(e){e.forEach(function(e){var t,n,i;for(t=0,n=e.addedNodes.length;n>t;t++)i=e.addedNodes[t],i.nodeType==Node.ELEMENT_NODE&&o.forEach(function(e){e(i)})})});o.forEach(function(e){e()}),i.observe(document.body,{childList:!0,subtree:!0})})},function(e,t,n){var i=function(e){var t=["fix-names","fold-comments","lightboxed-images","bottom-comment-link","colored-comment-icons"];e=e||{};var n={};return t.forEach(function(t){n[t]=t in e?e[t]:!0}),n},o={init:function(){},loadSettings:function(){return new Promise(function(e){setTimeout(function(){e(i())},0)})},saveSettings:function(e){return new Promise(function(e){setTimeout(e,0)})}},r={init:function(){var e=this;window.addEventListener("message",function(t){if("action"in t.data&&"getSettings"===t.data.action&&e.loadSettings().then(function(e){t.source.postMessage(e,t.origin)}),"action"in t.data&&"saveSettings"===t.data.action&&e.saveSettings(t.data.value),"action"in t.data&&"checkUpdates"===t.data.action){var n=Date.now(),i=localStorage["be-fe-version"];localStorage["be-fe-next-update"]=n+36e5;var o=new XMLHttpRequest;o.open("GET","https://api.github.com/repos/davidmz/BetterFeed/tags?page=1&&per_page=1"),o.responseType="json",o.onload=function(){try{var e=this.response;if(1==e.length&&"name"in e[0]){var t=e[0].name;localStorage["be-fe-version"]=t,localStorage["be-fe-next-update"]=n+864e5,alert(t!=i?"Доступна новая версия: "+t+". Она будет установлена после перезагрузки страницы.":"У вас установлена последняя версия")}}catch(o){}},o.send()}})},loadSettings:function(){return new Promise(function(e){var t;try{t=i(JSON.parse(localStorage["ffc-sac-settings"]))}catch(n){t=i()}e(t)})},saveSettings:function(e){return localStorage["ffc-sac-settings"]=JSON.stringify(e),new Promise(function(e){setTimeout(e,0)})}},s={init:function(){var e=this;this.loadResolver=null,this.parentOrigin="https://freefeed.net",window.addEventListener("message",function(t){t.origin===e.parentOrigin&&null!==e.loadResolver&&(e.loadResolver(i(t.data)),e.loadResolver=null)})},loadSettings:function(){var e=this;return new Promise(function(t){e.loadResolver=t,window.parent.postMessage({action:"getSettings",value:null},e.parentOrigin)})},saveSettings:function(e){var t=this;return new Promise(function(n){window.parent.postMessage({action:"saveSettings",value:e},t.parentOrigin),setTimeout(n,0)})}};"freefeed.net"===location.hostname?e.exports=r:window.parent?e.exports=s:e.exports=o},function(e,t,n){function i(e){return n(o(e))}function o(e){return r[e]||function(){throw new Error("Cannot find module '"+e+"'.")}()}var r={"./bottom-comment-link":4,"./bottom-comment-link.js":4,"./colored-comment-icons":5,"./colored-comment-icons.js":5,"./fix-names":6,"./fix-names.js":6,"./fold-comments":7,"./fold-comments.js":7,"./lightboxed-images":8,"./lightboxed-images.js":8,"./settings-link":3,"./settings-link.js":3};i.keys=function(){return Object.keys(r)},i.resolve=o,e.exports=i,i.id=2},function(e,t,n){var i=n(11);n(12);var o=i(".light-box-container.be-fe-settingsLB"),r=i(".frf-co-light-box.hidden",i(".light-box-shadow",o));e.exports=function(e){var t=localStorage["be-fe-version"];if(t){e=e||document.body;var n=e.querySelector(".sidebar");if(n&&!n.querySelector(".be-fe-settingsLink")){var s;n.appendChild(i(".box.be-fe-settingsLink",i("div",s=i("a","BetterFeed settings")),i("div",i("small",t)))),s.addEventListener("click",function(e){e.preventDefault(),document.body.appendChild(r),o.innerHTML="",o.appendChild(i("iframe.light-box-iframe",{src:"https://cdn.rawgit.com/davidmz/BetterFeed/"+t+"/src/options/options.html",frameborder:"0"})),r.classList.remove("hidden")})}}}},function(e,t,n){var i=n(15),o=n(11),r=n(16);e.exports=function(e){e=e||document.body,i(e,".p-timeline-post-comment-action:not(.be-fe-copied)",function(e){e.classList.add("be-fe-copied");var t=r(e,".post-body");if(t){var n=e.cloneNode();n.innerHTML="Add comment";var i=o(".be-fe-bottom-comment-link",n);t.querySelector(".comments").appendChild(i)}})}},function(e,t,n){var i=n(15),o=n(11),r=n(16),s=null;e.exports=function(e){e=e||document.body;var t=e.querySelector(".logged-user .author a");t&&(s=t.href.substr(1)),i(e,".post-body",function(e){var t=e.querySelector(".title a").href.substr(1);i(e,".comment:not(.be-fe-comment-from)",function(e){var n=e.querySelector(".author a");if(n){var i=n.href.substr(1);i==s?e.classList.add("be-fe-comment-from-me"):i==t&&e.classList.add("be-fe-comment-from-post-author"),e.classList.add("be-fe-comment-from")}})}),i(e,".comment:not(.be-fe-comment-from)",function(e){var t=r(e,".post-body").querySelector(".title a").href.substr(1),n=e.querySelector(".author a");if(n){var i=n.href.substr(1);i==s?e.classList.add("be-fe-comment-from-me"):i==t&&e.classList.add("be-fe-comment-from-post-author"),e.classList.add("be-fe-comment-from")}}),i(e,".comment .date:not(.be-fe-iconized)",function(e){e.classList.add("be-fe-iconized"),e.appendChild(o("i.fa.fa-comment.icon.be-fe-ico-bg"))})}},function(e,t,n){var i=n(15);e.exports=function(e){e=e||document.body,i(e,".post-body > .title a:not(.be-fe-nameFixed), .p-comment-body .author a:not(.be-fe-nameFixed), .p-timeline-user-like > a:not(.be-fe-nameFixed)",function(e){var t=e.getAttribute("href").substr(1),n=e.innerHTML;e.innerHTML=t,e.setAttribute("title",n),e.classList.add("be-fe-nameFixed")})}},function(e,t,n){var i=n(15),o=n(11);e.exports=function(e){e=e||document.body,i(e,".p-timeline-post > .comments",function(e){var t,n=e.querySelectorAll(":scope > .ember-view"),i=n.length;for(t=0;i>t;t++)i>7&&t>0&&i-1>t?n[t].classList.add("be-fe-comment-folded"):n[t].classList.remove("be-fe-comment-folded");if(!(7>=i)){var r=e.querySelector(".be-fe-comments-fold-handle");if(r)r.querySelector("a").innerHTML=i-2+" more comments";else{var s=o("a",i-2+" more comments");r=o(".be-fe-comments-fold-handle",s),s.addEventListener("click",function(t){t.preventDefault(),e.classList.add("be-fe-comments-expanded")})}e.insertBefore(r,n[1])}})}},function(e,t,n){n(12);var i=n(17),o=n(15),r=n(16),s=new i;document.body.addEventListener("click",function(e){var t=r(e.target,".light-box-thumbnail",!0);if(t&&0==e.button){e.preventDefault();var n=[t],i=r(t,".attachments");i&&(n=o(i,".light-box-thumbnail")),s.show(n,t)}},!1),e.exports=function(e){e=e||document.body,o(e,".p-attachment-url:not(.light-box-thumbnail)",function(e){e.dataset.imageSrc?e.classList.add("light-box-thumbnail"):/\.(jpe?g|png|gif)/i.test(e.href)&&(e.dataset.imageSrc=e.href,e.classList.add("light-box-thumbnail"))})}},function(e,t,n){var i=n(10);"string"==typeof i&&(i=[[e.id,i,""]]);n(14)(i,{});i.locals&&(e.exports=i.locals)},function(e,t,n){t=e.exports=n(18)(),t.push([e.id,".be-fe-bottom-comment-link,.be-fe-comments-fold-handle,.be-fe-in-comments-link{font-style:italic;margin-left:21px}.be-fe-comment-folded{display:none}.be-fe-comments-expanded .be-fe-comment-folded{display:block}.be-fe-bottom-comment-link:first-child,.be-fe-comments-expanded .be-fe-comments-fold-handle,.comment+.be-fe-bottom-comment-link{display:none}.date.be-fe-iconized{position:relative}.date.be-fe-iconized .icon{position:absolute;top:0;left:0;z-index:1}.date.be-fe-iconized .icon.be-fe-ico-bg{z-index:0}.be-fe-ico-bg{color:#fff}.be-fe-comment-from-me .be-fe-ico-bg{color:#ffd87b}.be-fe-comment-from-post-author .be-fe-ico-bg{color:#ddd}",""])},function(e,t,n){e.exports=function(e,t,n){var i,o,r=e.split("."),s=r.shift()||"div",a=document.createElement(s);r.length>0&&(a.className=r.join(" "));var c=1;if(arguments.length>1&&"object"==typeof t&&!(t instanceof Node)){for(o in t)t.hasOwnProperty(o)&&a.setAttribute(o,t[o]);c=2}if(arguments.length>c)for(i=c;i<arguments.length;i++){var d=arguments[i];d instanceof Node?a.appendChild(d):"string"==typeof d&&a.appendChild(document.createTextNode(d))}return a}},function(e,t,n){var i=n(13);"string"==typeof i&&(i=[[e.id,i,""]]);n(14)(i,{});i.locals&&(e.exports=i.locals)},function(e,t,n){t=e.exports=n(18)(),t.push([e.id,'.frf-co-light-box.first .light-box-arrow.left,.frf-co-light-box.hidden,.frf-co-light-box.last .light-box-arrow.right{display:none}.light-box-arrow{position:absolute;left:0;top:50%;margin-top:-60px;width:90px;height:120px;color:#fff;cursor:pointer}.light-box-arrow:hover{background:rgba(255,255,255,.1)}.light-box-arrow::before{content:"";position:absolute;left:20px;top:50%;margin-top:-15px;width:30px;height:30px;border-top:5px solid;border-right:5px solid;-webkit-transform:rotate(45deg);transform:rotate(45deg)}.light-box-arrow.left::before{left:auto;right:20px;-webkit-transform:rotate(-135deg);transform:rotate(-135deg)}.light-box-arrow.right{left:auto;right:0}.light-box-shadow{position:fixed;top:0;left:0;width:100%;height:100%;display:-webkit-flex;display:flex;-webkit-justify-content:center;justify-content:center;-webkit-align-items:center;align-items:center;z-index:100;cursor:zoom-out;background:rgba(0,0,0,.4)}.light-box-container{width:90%;height:90%;display:-webkit-flex;display:flex;-webkit-justify-content:center;justify-content:center;-webkit-align-items:center;align-items:center}.light-box-img{border:1px solid #000;box-shadow:1px 1px 10px rgba(0,0,0,.5);max-width:100%;max-height:100%;margin:auto;background-color:#fff;cursor:pointer}.light-box-iframe{background:#fff;width:100%;height:100%}.light-box-thumbnail{cursor:zoom-in!important}',""])},function(e,t,n){function i(e,t){for(var n=0;n<e.length;n++){var i=e[n],o=l[i.id];if(o){o.refs++;for(var r=0;r<o.parts.length;r++)o.parts[r](i.parts[r]);for(;r<i.parts.length;r++)o.parts.push(a(i.parts[r],t))}else{for(var s=[],r=0;r<i.parts.length;r++)s.push(a(i.parts[r],t));l[i.id]={id:i.id,refs:1,parts:s}}}}function o(e){for(var t=[],n={},i=0;i<e.length;i++){var o=e[i],r=o[0],s=o[1],a=o[2],c=o[3],d={css:s,media:a,sourceMap:c};n[r]?n[r].parts.push(d):t.push(n[r]={id:r,parts:[d]})}return t}function r(){var e=document.createElement("style"),t=m();return e.type="text/css",t.appendChild(e),e}function s(){var e=document.createElement("link"),t=m();return e.rel="stylesheet",t.appendChild(e),e}function a(e,t){var n,i,o;if(t.singleton){var a=g++;n=p||(p=r()),i=c.bind(null,n,a,!1),o=c.bind(null,n,a,!0)}else e.sourceMap&&"function"==typeof URL&&"function"==typeof URL.createObjectURL&&"function"==typeof URL.revokeObjectURL&&"function"==typeof Blob&&"function"==typeof btoa?(n=s(),i=f.bind(null,n),o=function(){n.parentNode.removeChild(n),n.href&&URL.revokeObjectURL(n.href)}):(n=r(),i=d.bind(null,n),o=function(){n.parentNode.removeChild(n)});return i(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;i(e=t)}else o()}}function c(e,t,n,i){var o=n?"":i.css;if(e.styleSheet)e.styleSheet.cssText=b(t,o);else{var r=document.createTextNode(o),s=e.childNodes;s[t]&&e.removeChild(s[t]),s.length?e.insertBefore(r,s[t]):e.appendChild(r)}}function d(e,t){var n=t.css,i=t.media;t.sourceMap;if(i&&e.setAttribute("media",i),e.styleSheet)e.styleSheet.cssText=n;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(n))}}function f(e,t){var n=t.css,i=(t.media,t.sourceMap);i&&(n+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(i))))+" */");var o=new Blob([n],{type:"text/css"}),r=e.href;e.href=URL.createObjectURL(o),r&&URL.revokeObjectURL(r)}var l={},u=function(e){var t;return function(){return"undefined"==typeof t&&(t=e.apply(this,arguments)),t}},h=u(function(){return/msie [6-9]\b/.test(window.navigator.userAgent.toLowerCase())}),m=u(function(){return document.head||document.getElementsByTagName("head")[0]}),p=null,g=0;e.exports=function(e,t){t=t||{},"undefined"==typeof t.singleton&&(t.singleton=h());var n=o(e);return i(n,t),function(e){for(var r=[],s=0;s<n.length;s++){var a=n[s],c=l[a.id];c.refs--,r.push(c)}if(e){var d=o(e);i(d,t)}for(var s=0;s<r.length;s++){var c=r[s];if(0===c.refs){for(var f=0;f<c.parts.length;f++)c.parts[f]();delete l[c.id]}}}};var b=function(){var e=[];return function(t,n){return e[t]=n,e.filter(Boolean).join("\n")}}()},function(e,t,n){e.exports=function(e,t,n){var i=Array.prototype.slice.call(e.querySelectorAll(t));if(n)for(var o=0,r=i.length;r>o;o++)n(i[o]);return i}},function(e,t,n){var i=function(e,t,n){n=n||!1;var o=n?e:e.parentNode;return o&&o.nodeType==Node.ELEMENT_NODE?o.matches(t)?o:i(o,t):null};e.exports=i},function(e,t,n){var i=n(11),o=n(16),r=function(){this.image=i("img"),this.cache={},this.queue=[],this.image.addEventListener("load",this.moveQueue.bind(this)),this.image.addEventListener("error",this.moveQueue.bind(this)),this.moveQueue()};r.prototype.add=function(e){e in this.cache||(this.cache[e]=!0,this.queue.push(e))},r.prototype.moveQueue=function(){var e=this.queue.pop();void 0!==e?this.image.src=e:setTimeout(this.moveQueue.bind(this),250)};var s=function(){this.imageStab="https://cdnjs.cloudflare.com/ajax/libs/galleriffic/2.0.1/css/loader.gif",this.lightBoxImage=i("img.light-box-img",{src:this.imageStab}),this.lightBox=i(".frf-co-light-box.first.last.hidden",i(".light-box-shadow",i(".light-box-container",this.lightBoxImage),i(".light-box-arrow.left"),i(".light-box-arrow.right"))),this.cList=this.lightBox.classList,this.preloader=new r,this.hidden=!0,this.slides=[],this.index=0,document.body.appendChild(this.lightBox),document.body.addEventListener("keydown",function(e){this.hidden||(27==e.keyCode?this.hide():39==e.keyCode?(this.next(),e.preventDefault()):37==e.keyCode?(this.prev(),e.preventDefault()):36==e.keyCode?(this.first(),e.preventDefault()):35==e.keyCode&&(this.last(),e.preventDefault()))}.bind(this),!0),this.lightBox.addEventListener("click",function(e){var t;null!==(t=o(e.target,".light-box-arrow",!0))?(e.stopPropagation(),t.classList.contains("left")?this.prev():t.classList.contains("right")&&this.next()):o(e.target,".light-box-shadow",!0)&&this.hide()}.bind(this)),this.lightBoxImage.addEventListener("click",function(){window.open(this.slides[this.index].href,"_blank")}.bind(this))};s.prototype.isFirst=function(){return 0===this.index},s.prototype.isLast=function(){return this.index===this.slides.length-1},s.prototype.show=function(e,t){this.slides=e,e.forEach(function(e,n){e===t?this.index=n:this.preloader.add(e.dataset.imageSrc)}.bind(this)),this.hidden=!1,this.cList.remove("hidden"),this._showCurrent()},s.prototype._showCurrent=function(){this.lightBoxImage.src=this.imageStab,this.lightBoxImage.src=this.slides[this.index].dataset.imageSrc,this.lightBoxImage.style="",this.isFirst()?this.cList.add("first"):this.cList.remove("first"),this.isLast()?this.cList.add("last"):this.cList.remove("last")},s.prototype.hide=function(){this.hidden||(this.hidden=!0,this.cList.add("hidden"))},s.prototype.next=function(){this.hidden||this.isLast()||(this.index++,this._showCurrent())},s.prototype.prev=function(){this.hidden||this.isFirst()||(this.index--,this._showCurrent())},s.prototype.first=function(){this.hidden||this.isFirst()||(this.index=0,this._showCurrent())},s.prototype.last=function(){this.hidden||this.isLast()||(this.index=this.slides.length-1,this._showCurrent())},e.exports=s},function(e,t,n){e.exports=function(){var e=[];return e.toString=function(){for(var e=[],t=0;t<this.length;t++){var n=this[t];e.push(n[2]?"@media "+n[2]+"{"+n[1]+"}":n[1])}return e.join("")},e.i=function(t,n){"string"==typeof t&&(t=[[null,t,""]]);for(var i={},o=0;o<this.length;o++){var r=this[o][0];"number"==typeof r&&(i[r]=!0)}for(o=0;o<t.length;o++){var s=t[o];"number"==typeof s[0]&&i[s[0]]||(n&&!s[2]?s[2]=n:n&&(s[2]="("+s[2]+") and ("+n+")"),e.push(s))}},e}}]);